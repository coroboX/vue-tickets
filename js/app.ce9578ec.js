(function(t){function e(e){for(var a,n,c=e[0],o=e[1],l=e[2],h=0,p=[];h<c.length;h++)n=c[h],Object.prototype.hasOwnProperty.call(i,n)&&i[n]&&p.push(i[n][0]),i[n]=0;for(a in o)Object.prototype.hasOwnProperty.call(o,a)&&(t[a]=o[a]);u&&u(e);while(p.length)p.shift()();return r.push.apply(r,l||[]),s()}function s(){for(var t,e=0;e<r.length;e++){for(var s=r[e],a=!0,c=1;c<s.length;c++){var o=s[c];0!==i[o]&&(a=!1)}a&&(r.splice(e--,1),t=n(n.s=s[0]))}return t}var a={},i={app:0},r=[];function n(e){if(a[e])return a[e].exports;var s=a[e]={i:e,l:!1,exports:{}};return t[e].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=t,n.c=a,n.d=function(t,e,s){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)n.d(s,a,function(e){return t[e]}.bind(null,a));return s},n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/vue-tickets/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],o=c.push.bind(c);c.push=e,c=c.slice();for(var l=0;l<c.length;l++)e(c[l]);var u=o;r.push([0,"chunk-vendors"]),s()})({0:function(t,e,s){t.exports=s("56d7")},"56d7":function(t,e,s){"use strict";s.r(e);s("e260"),s("e6cf"),s("cca6"),s("a79d");var a=s("2b0e"),i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"app"}},[t._m(0),s("Canvas"),s("main",{staticClass:"content"},[s("FilterCard",{attrs:{filter:t.filterState},on:{"currency-changed":function(e){return t.handleCurrencyChange(e)},only:function(e){return t.handleOnlyStop(e)}}}),s("TicketsList",{attrs:{currencyRates:t.rates,cur:t.filterState.currency,stops:t.filterState.stops}})],1)],1)},r=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("header",{staticClass:"header"},[a("img",{staticClass:"header__logo",attrs:{src:s("9b19"),alt:"logo that displays white plane on blue circle"}})])}],n=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"filter"},[s("div",{staticClass:"filter-form",attrs:{name:"filter"}},[s("p",{staticClass:"filter-form__description"},[t._v(" Валюта ")]),s("div",{staticClass:"radio-group"},[s("label",{staticClass:"radio-label"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.currency,expression:"currency"}],attrs:{type:"radio",name:"radio",value:"RUB"},domProps:{checked:t._q(t.currency,"RUB")},on:{change:[function(e){t.currency="RUB"},function(e){return t.$emit("currency-changed",t.currency)}]}}),s("span",{staticClass:"radiomark"},[t._v("Rub")])]),s("label",{staticClass:"radio-label"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.currency,expression:"currency"}],attrs:{type:"radio",name:"radio",value:"USD"},domProps:{checked:t._q(t.currency,"USD")},on:{change:[function(e){t.currency="USD"},function(e){return t.$emit("currency-changed",t.currency)}]}}),s("span",{staticClass:"radiomark"},[t._v("Usd")])]),s("label",{staticClass:"radio-label"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.currency,expression:"currency"}],attrs:{type:"radio",name:"radio",value:"EUR"},domProps:{checked:t._q(t.currency,"EUR")},on:{change:[function(e){t.currency="EUR"},function(e){return t.$emit("currency-changed",t.currency)}]}}),s("span",{staticClass:"radiomark"},[t._v("Eur")])])]),s("p",{staticClass:"filter-form__description"},[t._v(" Количество пересадок ")]),s("div",{staticClass:"check-group",on:{change:function(e){return t.$emit("stops-changed",t.stops)}}},[s("label",{staticClass:"checkbox-label"},[t._v("Все "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.stops["all"],expression:"stops['all']"}],attrs:{type:"checkbox",name:"all"},domProps:{checked:Array.isArray(t.stops["all"])?t._i(t.stops["all"],null)>-1:t.stops["all"]},on:{change:[function(e){var s=t.stops["all"],a=e.target,i=!!a.checked;if(Array.isArray(s)){var r=null,n=t._i(s,r);a.checked?n<0&&t.$set(t.stops,"all",s.concat([r])):n>-1&&t.$set(t.stops,"all",s.slice(0,n).concat(s.slice(n+1)))}else t.$set(t.stops,"all",i)},t.handleAll]}}),s("span",{staticClass:"checkmark checkmark--all"})]),s("label",{staticClass:"checkbox-label"},[t._v("Без пересадок "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.stops[0],expression:"stops[0]"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.stops[0])?t._i(t.stops[0],null)>-1:t.stops[0]},on:{change:[function(e){var s=t.stops[0],a=e.target,i=!!a.checked;if(Array.isArray(s)){var r=null,n=t._i(s,r);a.checked?n<0&&t.$set(t.stops,0,s.concat([r])):n>-1&&t.$set(t.stops,0,s.slice(0,n).concat(s.slice(n+1)))}else t.$set(t.stops,0,i)},function(e){return t.handleStops(0)}]}}),s("span",{staticClass:"checkmark"}),s("button",{staticClass:"checkbox-label__only",on:{click:function(e){return t.$emit("only",0)}}},[t._v(" Только ")])]),s("label",{staticClass:"checkbox-label"},[t._v("1 пересадка "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.stops[1],expression:"stops[1]"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.stops[1])?t._i(t.stops[1],null)>-1:t.stops[1]},on:{change:[function(e){var s=t.stops[1],a=e.target,i=!!a.checked;if(Array.isArray(s)){var r=null,n=t._i(s,r);a.checked?n<0&&t.$set(t.stops,1,s.concat([r])):n>-1&&t.$set(t.stops,1,s.slice(0,n).concat(s.slice(n+1)))}else t.$set(t.stops,1,i)},function(e){return t.handleStops(1)}]}}),s("span",{staticClass:"checkmark"}),s("button",{staticClass:"checkbox-label__only",on:{click:function(e){return t.$emit("only",1)}}},[t._v(" Только ")])]),s("label",{staticClass:"checkbox-label"},[t._v("2 пересадки "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.stops[2],expression:"stops[2]"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.stops[2])?t._i(t.stops[2],null)>-1:t.stops[2]},on:{change:[function(e){var s=t.stops[2],a=e.target,i=!!a.checked;if(Array.isArray(s)){var r=null,n=t._i(s,r);a.checked?n<0&&t.$set(t.stops,2,s.concat([r])):n>-1&&t.$set(t.stops,2,s.slice(0,n).concat(s.slice(n+1)))}else t.$set(t.stops,2,i)},function(e){return t.handleStops(2)}]}}),s("span",{staticClass:"checkmark"}),s("button",{staticClass:"checkbox-label__only",on:{click:function(e){return t.$emit("only",2)}}},[t._v(" Только ")])]),s("label",{staticClass:"checkbox-label"},[t._v("3 пересадки "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.stops[3],expression:"stops[3]"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.stops[3])?t._i(t.stops[3],null)>-1:t.stops[3]},on:{change:[function(e){var s=t.stops[3],a=e.target,i=!!a.checked;if(Array.isArray(s)){var r=null,n=t._i(s,r);a.checked?n<0&&t.$set(t.stops,3,s.concat([r])):n>-1&&t.$set(t.stops,3,s.slice(0,n).concat(s.slice(n+1)))}else t.$set(t.stops,3,i)},function(e){return t.handleStops(3)}]}}),s("span",{staticClass:"checkmark"}),s("button",{staticClass:"checkbox-label__only",on:{click:function(e){return t.$emit("only",3)}}},[t._v(" Только ")])])])])])},c=[],o=(s("4de4"),{name:"FilterCard",props:{filter:Object},data:function(){var t=this.filter,e=t.currentCurrency,s=t.stops;return{currency:e,stops:s}},methods:{handleAll:function(){var t=this.stops.all;if(t)for(var e in this.stops)this.stops[e]=!0},handleStops:function(t){this.stops[t]||(this.stops.all=!1)}},mounted:function(){this.currency=this.filter.currency}}),l=o,u=(s("e2c1"),s("2877")),h=Object(u["a"])(l,n,c,!1,null,null,null),p=h.exports,d=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("transition-group",{staticClass:"tickets",attrs:{name:"staggered-fade",tag:"section",css:!1},on:{"before-enter":t.beforeEnter,enter:t.enter,leave:t.leave}},t._l(t.filteredTickets,(function(e,a){return s("TicketCard",{key:e.id,attrs:{"data-index":a,ticket:e,currency:t.currency}})})),1)},v=[],f=(s("99af"),s("4160"),s("d81d"),s("4fad"),s("ac1f"),s("5319"),s("1276"),s("159b"),s("2909")),_=s("5530"),y=s("3835"),m=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"ticket"},[s("div",{staticClass:"ticket__action"},[s("div",{class:"ticket__carrier-logo "+t.carrier}),s("button",{staticClass:"button ticket__button"},[s("p",{staticClass:"button__description"},[t._v(" Купить ")]),s("p",{staticClass:"button__price"},[t._v(" за "+t._s(t.price)+" ")])])]),s("div",{staticClass:"ticket__descriptions"},[s("div",{staticClass:"ticket__departure"},[s("p",{staticClass:"ticket__time ticket__time--departure"},[t._v(" "+t._s(t.departure_time)+" ")]),s("p",{staticClass:"ticket__place ticket__place--departure"},[t._v(" "+t._s(t.origin)+", "+t._s(t.origin_name)+" ")]),s("p",{staticClass:"ticket__date ticket__date--departure"},[t._v(" "+t._s(t.departure_date)+" ")])]),s("div",{staticClass:"ticket__arrival"},[s("p",{staticClass:"ticket__time ticket__time--arrival"},[t._v(" "+t._s(t.arrival_time)+" ")]),s("p",{staticClass:"ticket__place ticket__place--arrival"},[t._v(" "+t._s(t.destination_name)+", "+t._s(t.destination)+" ")]),s("p",{staticClass:"ticket__date ticket__date--arrival"},[t._v(" "+t._s(t.arrival_date)+" ")])]),s("div",{staticClass:"ticket__stops"},[s("span",{staticClass:"ticket__stops-text"},[t._v(" "+t._s(t.stops)+" ")]),s("div",{staticClass:"ticket__arrow"})])])])},b=[],k={name:"TicketCard",props:{ticket:Object,currency:String},data:function(){var t=this.ticket,e=t.origin,s=t.origin_name,a=t.destination,i=t.destination_name,r=t.departure_date,n=t.departure_time,c=t.arrival_date,o=t.arrival_time,l=t.carrier,u=t.stops,h=t.prices;return{origin:e,origin_name:s,destination:a,destination_name:i,departure_date:r,departure_time:n,arrival_date:c,arrival_time:o,carrier:l,stops:u,price:h[this.currency],prices:h}},watch:{currency:function(t){this.price=this.prices[t]}}},g=k,x=(s("9917"),Object(u["a"])(g,m,b,!1,null,"1dba0792",null)),C=x.exports,S=s("ec26"),O=s("589d"),R=s.n(O),E=s("bc3a"),T=s.n(E),w=function(t,e){var s=t.split("."),a="20".concat(s[2],"-").concat(s[0],"-").concat(s[1]),i=new Date(a),r=i.toLocaleString(e,{month:"short"}).replace(".",""),n=i.toLocaleString(e,{weekday:"short"}),c=i.getDate(),o=i.getFullYear();return"".concat(c," ").concat(r," ").concat(o,", ").concat(n)},A=function(t){var e={0:"Без пересадок",1:"1 пересадка",2:"2 пересадки",3:"3 пересадки"};return e[t]},M=function(t,e){var s=Object.entries(e),a={};return s.forEach((function(e){for(var s=Object(y["a"])(e,2),i=s[0],r=s[1],n=r.sym,c=r.val,o=Math.round(t/c),l=""+o,u=l.length,h="",p=1;p<=u;p+=1)h=p%3-1?l[u-p]+h:l[u-p]+" "+h;a[i]="".concat(h).concat(n)})),a},$=function(t,e,s){var a=t.arrival_date,i=t.departure_date,r=t.stops,n=t.price,c=w(a,e),o=w(i,e),l=A(r),u=M(n,s);return Object(_["a"])(Object(_["a"])({},t),{},{id:Object(S["a"])(),arrival_date:c,departure_date:o,stops:l,prices:u})},L=function(t,e){var s="ru-ru";return e.map((function(e){return $(e,s,t)}))},j={name:"TicketsList",props:{rawTickets:Array,currencyRates:Object,cur:String,stops:Object},components:{TicketCard:C},data:function(){var t=this.cur,e=this.stops;return{tickets:[],currency:t,stop:e}},methods:{beforeEnter:function(t){t.style.opacity=0},enter:function(t,e){var s=150*t.dataset.id;setTimeout((function(){R()(t,{opacity:1},{complete:e})}),s)},leave:function(t,e){var s=150*t.dataset.id;setTimeout((function(){R()(t,{opacity:0},{complete:e})}),s)}},computed:{formattedTickets:function(){var t=this.currencyRates,e=Object(f["a"])(this.tickets).sort((function(t,e){return t.price-e.price})),s=L(t,e);return s},filteredTickets:function(){var t={0:"Без пересадок",1:"1 пересадка",2:"2 пересадки",3:"3 пересадки"},e={};for(var s in this.stops)e[t[s]]=this.stops[s];var a=this.formattedTickets.filter((function(t){for(var s in e)if(t.stops===s&&e[s])return!0;return!1}));return a}},created:function(){var t=this;T.a.get("https://my-json-server.typicode.com/coroboX/vue-tickets-json/tickets").then((function(e){t.tickets=Object(f["a"])(e.data),console.log("tickets loaded from https://my-json-server.typicode.com/coroboX/vue-tickets-json")})).catch((function(t){return console.log(t)}))},watch:{cur:function(t){this.currency=t}}},U=j,z=Object(u["a"])(U,d,v,!1,null,"63dc1e6b",null),D=z.exports,H=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("canvas",{ref:"my-canvas",on:{resize:t.resize,mousemove:t.onMouseMove,touchmove:t.onTouchMove,touchend:t.onMouseLeave,mouseleave:t.onMouseLeave}})])},P=[],N={name:"Canvas",data:function(){return{STAR_COUNT:0,STAR_SIZE:0,STAR_MIN_SCALE:0,OVERFLOW_THRESHOLD:0,scale:1,width:0,height:0,stars:[],pointerX:0,pointerY:0,velocity:{x:0,y:0,tx:0,ty:0,z:5e-4},touchInput:!1,canvas:null,context:null}},mounted:function(){this.STAR_COUNT=(this.$refs["my-canvas"].clientWidth+this.$refs["my-canvas"].clientHeight)/8,this.STAR_SIZE=3,this.STAR_MIN_SCALE=.2,this.OVERFLOW_THRESHOLD=50,this.canvas=document.querySelector("canvas"),this.context=this.$refs["my-canvas"].getContext("2d"),this.generate(),this.resize(),this.step(),window.addEventListener("resize",this.resizeCallBack)},beforeDestroy:function(){window.removeEventListener("resize",this.resizeCallBack)},methods:{resizeCallBack:function(){this.resize()},generate:function(){console.log(this.STAR_COUNT),console.log(this),console.log(this.$refs["my-canvas"].clientHeight);for(var t=0;t<this.STAR_COUNT;t++)this.stars.push({x:0,y:0,z:this.STAR_MIN_SCALE+Math.random()*(1-this.STAR_MIN_SCALE)})},placeStar:function(t){t.x=Math.random()*this.width,t.y=Math.random()*this.height},recycleStar:function(t){var e,s="z",a=Math.abs(this.velocity.x),i=Math.abs(this.velocity.y);(a>1||i>1)&&(e=a>i?Math.random()<a/(a+i)?"h":"v":Math.random()<i/(a+i)?"v":"h",s="h"===e?this.velocity.x>0?"l":"r":this.velocity.y>0?"t":"b");t.z=this.STAR_MIN_SCALE+Math.random()*(1-this.STAR_MIN_SCALE),"z"===s?(t.z=.1,t.x=Math.random()*this.width,t.y=Math.random()*this.height):"l"===s?(t.x=-this.OVERFLOW_THRESHOLD,t.y=this.height*Math.random()):"r"===s?(t.x=this.width+this.OVERFLOW_THRESHOLD,t.y=this.height*Math.random()):"t"===s?(t.x=this.width*Math.random(),t.y=-this.OVERFLOW_THRESHOLD):"b"===s&&(t.x=this.width*Math.random(),t.y=this.height+this.OVERFLOW_THRESHOLD)},resize:function(){this.scale=window.devicePixelRatio||1,this.width=this.$refs["my-canvas"].clientWidth*this.scale,this.height=this.$refs["my-canvas"].clientHeight*this.scale,this.canvas.width=this.width,this.canvas.height=this.height,this.stars.forEach(this.placeStar)},step:function(){this.context.clearRect(0,0,this.width,this.height),this.update(),this.render(),requestAnimationFrame(this.step)},update:function(){var t=this;this.velocity.tx*=.96,this.velocity.ty*=.96,this.velocity.x+=.8*(this.velocity.tx-this.velocity.x),this.velocity.y+=.8*(this.velocity.ty-this.velocity.y),this.stars.forEach((function(e){e.x+=t.velocity.x*e.z,e.y+=t.velocity.y*e.z,e.x+=(e.x-t.width/2)*t.velocity.z*e.z,e.y+=(e.y-t.height/2)*t.velocity.z*e.z,e.z+=t.velocity.z,(e.x<-t.OVERFLOW_THRESHOLD||e.x>t.width+t.OVERFLOW_THRESHOLD||e.y<-t.OVERFLOW_THRESHOLD||e.y>t.height+t.OVERFLOW_THRESHOLD)&&t.recycleStar(e)}))},render:function(){var t=this;this.stars.forEach((function(e){t.context.beginPath(),t.context.lineCap="round",t.context.lineWidth=t.STAR_SIZE*e.z*t.scale,t.context.strokeStyle="rgba(255,255,255,"+(.5+.5*Math.random())+")",t.context.beginPath(),t.context.moveTo(e.x,e.y);var s=2*t.velocity.x,a=2*t.velocity.y;Math.abs(s)<.1&&(s=.5),Math.abs(a)<.1&&(a=.5),t.context.lineTo(e.x+s,e.y+a),t.context.stroke()}))},movePointer:function(t,e){if("number"===typeof this.pointerX&&"number"===typeof this.pointerY){var s=t-this.pointerX,a=e-this.pointerY;this.velocity.tx=this.velocity.tx+s/8*this.scale*(this.touchInput?1:-1),this.velocity.ty=this.velocity.ty+a/8*this.scale*(this.touchInput?1:-1)}this.pointerX=t,this.pointerY=e},onMouseMove:function(t){this.touchInput=!1,this.movePointer(t.offsetX,t.offsetY)},onTouchMove:function(t){this.touchInput=!0,this.movePointer(t.touches[0].clientX,t.touches[0].clientY,!0),t.preventDefault()},onMouseLeave:function(){this.pointerX=null,this.pointerY=null}}},F=N,I=(s("dae6"),Object(u["a"])(F,H,P,!1,null,"38e764b0",null)),W=I.exports,B={name:"App",components:{FilterCard:p,TicketsList:D,Canvas:W},data:function(){return{rates:{RUB:{sym:"₽",val:1},USD:{sym:"$",val:70.73},EUR:{sym:"€",val:79.89}},filterState:{currency:"RUB",stops:{0:!0,1:!0,2:!0,3:!0,all:!0}}}},methods:{handleCurrencyChange:function(t){this.filterState.currency=t},handleOnlyStop:function(t){var e=this.filterState.stops;for(var s in e)e[s]=!1;e[t]=!0,this.filterState.stops=e}},created:function(){var t=this;T.a.get("https://api.exchangeratesapi.io/latest?symbols=USD,RUB").then((function(e){var s=e.data.rates;t.rates.EUR.val=s.RUB,t.rates.USD.val=s.RUB/s.USD,console.log("rates from exchangeratesapi.io:"),console.log("USD: ",t.rates.USD.val,"EUR: ",t.rates.EUR.val)})).catch((function(t){return console.log(t)}))}},V=B,X=(s("5c0b"),Object(u["a"])(V,i,r,!1,null,null,null)),Y=X.exports;a["a"].config.productionTip=!1,new a["a"]({render:function(t){return t(Y)}}).$mount("#app")},"5c0b":function(t,e,s){"use strict";var a=s("9c0c"),i=s.n(a);i.a},9917:function(t,e,s){"use strict";var a=s("ae81"),i=s.n(a);i.a},"9b19":function(t,e,s){t.exports=s.p+"img/logo.b2168910.svg"},"9c0c":function(t,e,s){},ae81:function(t,e,s){},b300:function(t,e,s){},dae6:function(t,e,s){"use strict";var a=s("e1bf"),i=s.n(a);i.a},e1bf:function(t,e,s){},e2c1:function(t,e,s){"use strict";var a=s("b300"),i=s.n(a);i.a}});
//# sourceMappingURL=app.ce9578ec.js.map